@use '@/styles' as theme;
@use '@/styles/glass' as glass;

// =============================================================================
// FLOATING ACTIONS - Undo/Redo/Zoom Controls
// =============================================================================
// Fixed corner position with RTL/LTR awareness
// LTR (English): Bottom-left | RTL (Hebrew): Bottom-right
//
// NOTE ON !important USAGE:
// - RTL margins (.rtl > *): Force correct alignment in right-to-left layouts
// - Action button styles: Override base Button component styles to achieve
//   minimal transparent button appearance required for this floating UI
// =============================================================================

.container {
  // Fixed position - corner varies by language direction
  position: fixed;
  bottom: 20px;
  z-index: theme.$z-index-modal;

  // Vertical stack of pills
  display: flex;
  flex-direction: column;
  gap: theme.$spacing-2;
}

// LTR (English): Bottom-left, align pills to left edge
// Position away from scrollbar - standard scrollbar is ~17px, add 8px buffer
.ltr {
  left: 25px;
  right: auto;
  align-items: flex-start;
}

// RTL (Hebrew): Bottom-right, align pills to right edge
// Position from right edge with scrollbar clearance (typically 17px scrollbar + buffer)
.rtl {
  // Position away from scrollbar - standard scrollbar is ~17px, add 8px buffer
  right: 25px;
  left: auto;
  // Align pills to the right edge of the container
  align-items: flex-end;

  // Force all direct children (motion.div pills) to align right
  // margin-left: auto in a column flex pushes items to the right
  // !important: Required to override Framer Motion's inline margin styles
  > * {
    margin-left: auto !important;
    margin-right: 0 !important;
  }
}

.pill {
  // Force LTR direction inside pills - buttons represent time/history
  // and should keep consistent spatial relationship regardless of page direction
  direction: ltr;

  // Reset any inherited margins that could push content off-screen
  margin: 0;

  display: flex;
  flex-direction: row;
  align-items: center;
  padding: theme.$spacing-1;

  // Glass effect using shared mixin
  @include glass.glass-panel;

  // Ensure pill hugs content tightly - no extra width
  width: fit-content;
  max-width: calc(
    100vw - 50px
  ); // Prevent overflow beyond viewport (account for scrollbar + margin)

  // Override glass mixin border radius for pill shape
  border-radius: theme.$border-radius-pill;
}

// Action buttons need !important to override the base Button component styles.
// These buttons require a minimal, transparent appearance that differs significantly
// from standard buttons, and the Button component's base styles would otherwise win.
.actionButton {
  // Reset button to transparent base
  @include theme.button-reset;
  min-width: 32px !important;
  min-height: 32px !important;
  padding: theme.$spacing-1-5 !important;
  border-radius: theme.$border-radius-full !important;
  outline: none !important;
  -webkit-tap-highlight-color: transparent;

  &:hover:not(:disabled) {
    background: var(--color-surface-hover) !important;
  }

  // Hide focus outline on mouse/touch, but preserve for keyboard navigation
  &:focus:not(:focus-visible) {
    outline: none !important;
    box-shadow: none !important;
  }

  // Only show focus for keyboard navigation
  &:focus-visible {
    outline: 2px solid var(--color-primary) !important;
    outline-offset: 2px !important;
  }

  &:active:not(:disabled) {
    background: var(--color-surface-pressed) !important;
    transform: scale(0.95);
    outline: none !important;
  }

  &:disabled {
    opacity: theme.$opacity-50;
    cursor: not-allowed;
  }
}

.pillSeparator {
  width: 1px;
  height: 20px;
  background: var(--color-border);
  margin: 0 theme.$spacing-0-5;
}

.zoomIndicator {
  padding: theme.$spacing-1 theme.$spacing-2;
  font-size: theme.$font-size-xs;
  font-weight: theme.$font-weight-medium;
  color: var(--color-text-muted);
  min-width: 44px;
  text-align: center;
  user-select: none;
  cursor: default;
}

// Mobile styles
@media (max-width: theme.$breakpoint-md) {
  .container {
    // Use CSS custom property set by RadialDock for smooth sync during drag
    // --dock-toolbar-height is updated in real-time during drag gestures
    // Add 48px for the tab height + 8px gap
    bottom: calc(
      var(--dock-toolbar-height, 0px) + 10px + 8px + env(safe-area-inset-bottom)
    );
    // No transition - we want instant sync with drag gesture
  }

  .ltr {
    left: 20px; // Smaller offset for mobile (thinner scrollbars)
  }

  .rtl {
    right: 20px; // Smaller offset for mobile (thinner scrollbars)
  }

  .pill {
    padding: theme.$spacing-0-5;
  }

  .actionButton {
    min-width: 28px !important;
    min-height: 28px !important;
  }

  .zoomIndicator {
    font-size: theme.$font-size-2xs;
    padding: theme.$spacing-0-5 theme.$spacing-1-5;
    min-width: 36px;
  }

  .pillSeparator {
    height: 16px;
  }
}
