/**
 * Main stylesheet for SynchBoard application.
 * Imports design tokens and defines the global CSS custom properties theme system
 * for both light and dark modes, along with foundational styles.
 * Import order: design tokens first, then component-specific styles.
 */
@use 'styles/design-tokens' as dt;
@use 'styles/mixins' as mixins;

.app-content {
  padding-top: var(--banner-height, 0px);
  transition: padding-top var(--transition-duration-slow, 0.3s) ease-in-out;

  // Auth page needs to offset banner height to maintain full viewport coverage
  [data-auth-page] {
    margin-top: calc(-1 * var(--banner-height, 0px));
  }
}

/* --- Light Theme Variables --- */
:root,
body[data-theme='light'] {
  font-family: system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  // Dynamic layout properties
  --banner-height: 0px;

  // Transitions (used by ErrorBoundary)
  --transition-duration-normal: #{dt.$transition-normal};
  --transition-ease-in-out: #{dt.$transition-ease-in-out};

  // Z-index (used by ErrorBoundary)
  --z-index-modal: #{dt.$z-index-modal};

  --color-primary: #{dt.$color-primary};
  --color-primary-hover: #{dt.$color-primary-hover};
  --color-primary-light: #{dt.$color-primary-light};

  --color-secondary: #{dt.$color-gray-400};
  --color-secondary-hover: #{dt.$color-gray-600};

  --color-background: #{dt.$color-white};
  --color-surface: #{dt.$color-gray-50};
  --color-surface-elevated: #{dt.$color-white};
  --color-surface-hover: #{dt.$color-gray-100};

  --color-border: #{dt.$color-gray-200};
  --color-border-strong: #{dt.$color-gray-300};
  --color-border-light: #{dt.$color-gray-100};

  --color-text-primary: #{dt.$color-black};
  --color-text-secondary: #{dt.$color-gray-600};
  --color-text-muted: #{dt.$color-gray-500};
  --color-text-disabled: #{dt.$color-gray-400};

  --color-success: #{dt.$color-success};
  --color-success-light: #{dt.$color-success-light};
  --color-warning: #{dt.$color-warning};
  --color-warning-light: #{dt.$color-warning-light};
  --color-error: #{dt.$color-error};
  --color-error-light: #{dt.$color-error-light};
  --color-error-banner-bg: #{dt.$color-error-light};
  --color-error-banner-text: #{dt.$color-black};
  --color-error-banner-border: #{dt.$color-error};

  --color-overlay-light: rgba(0, 0, 0, 0.05);
  --color-overlay-medium: rgba(0, 0, 0, 0.25);
  --color-overlay-strong: #{dt.$color-backdrop};

  --color-canvas-background: #{dt.$color-board-light-default};
  --color-canvas-pattern: rgba(0, 0, 0, 0.03);

  --color-random-shapes-bg: #{dt.$color-random-shapes-bg-light};
  --color-random-shapes-pattern: #{dt.$color-random-shapes-pattern-light};

  --color-status-pending-border: #{dt.$color-status-pending-border-light};
  --color-status-confirmed-border: #{dt.$color-status-confirmed-border-light};
  --color-status-failed-border: #{dt.$color-status-failed-border-light};
  --color-status-failed-bg: #{dt.$color-status-failed-bg-light};

  --toolbar-background: linear-gradient(
    135deg,
    rgba(248, 250, 252, 0.95) 0%,
    rgba(241, 245, 249, 0.98) 100%
  );
  --toolbar-border: rgba(226, 232, 240, 0.6);
  --toolbar-shadow: #{dt.$shadow-sm}, 0 0 0 1px rgba(255, 255, 255, 0.4) inset;

  --nav-button-background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.8) 0%,
    rgba(248, 250, 252, 0.9) 100%
  );
  --nav-button-border: rgba(226, 232, 240, 0.6);
  --nav-button-text: #{dt.$color-gray-600};
  --nav-button-shadow: #{dt.$shadow-sm}, 0 0 0 1px rgba(255, 255, 255, 0.8) inset;
  --nav-button-hover-background: linear-gradient(
    135deg,
    rgba(255, 255, 255, 0.95) 0%,
    rgba(241, 245, 249, 1) 100%
  );
  --nav-button-hover-border: #{dt.$color-black};
  --nav-button-hover-text: #{dt.$color-black};
  --nav-button-hover-shadow: #{dt.$shadow-button-hover}, 0 0 0 1px rgba(255, 255, 255, 1) inset;

  --destructive-button-background: linear-gradient(
    135deg,
    rgba(254, 242, 242, 0.9) 0%,
    rgba(255, 237, 237, 0.95) 100%
  );
  --destructive-button-border: rgba(252, 165, 165, 0.4);
  --destructive-button-text: #{dt.$color-error-hover};
  --destructive-button-shadow: #{dt.$shadow-sm}, 0 0 0 1px rgba(254, 226, 226, 0.8) inset;
  --destructive-button-hover-background: linear-gradient(
    135deg,
    rgba(254, 226, 226, 0.95) 0%,
    rgba(252, 165, 165, 0.2) 100%
  );
  --destructive-button-hover-border: #{dt.$color-error-light};
  --destructive-button-hover-text: #{dt.$color-error-hover};
  --destructive-button-hover-shadow:
    #{dt.$shadow-button-hover}, 0 0 0 1px rgba(254, 202, 202, 1) inset;

  --language-toggle-bg: #e5e7eb;

  --btn-primary-bg: #{dt.$color-primary};
  --btn-primary-bg-hover: #{dt.$color-primary-hover};
  --btn-primary-text: #{dt.$color-white};

  --btn-secondary-bg: #{dt.$color-gray-50};
  --btn-secondary-bg-hover: #{dt.$color-gray-100};
  --btn-secondary-text: #{dt.$color-gray-700};
  --btn-secondary-border: #{dt.$color-gray-200};

  --btn-destructive-bg: #{dt.$color-error-hover};
  --btn-destructive-bg-hover: #{dt.$color-error};
  --btn-destructive-text: #{dt.$color-white};

  --btn-cta-bg: #{dt.$color-success};
  --btn-cta-bg-hover: #{dt.$color-success};
  --btn-cta-text: #{dt.$color-white};

  --btn-warning-bg: #{dt.$color-warning};
  --btn-warning-bg-hover: #{dt.$color-warning};
  --btn-warning-text: #{dt.$color-white};

  --btn-icon-bg-hover: #{dt.$color-gray-100};
  --btn-icon-text: #{dt.$color-gray-500};
  --btn-icon-active-border: #{dt.$color-primary};

  // Icon button glass backgrounds (light theme - white overlays)
  --icon-btn-bg: rgba(255, 255, 255, 0.15);
  --icon-btn-bg-hover: rgba(255, 255, 255, 0.25);
  --icon-btn-bg-active: rgba(255, 255, 255, 0.3);
  --icon-btn-bg-active-hover: rgba(255, 255, 255, 0.35);

  --scrollbar-track-bg: #{dt.$color-gray-100};
  --scrollbar-thumb-bg: #{dt.$color-gray-400};
  --scrollbar-thumb-hover-bg: #{dt.$color-gray-500};
  --scrollbar-corner-bg: #{dt.$color-gray-100};

  --google-button-bg: #{dt.$google-button-bg-light};
  --google-button-text: #{dt.$google-button-text-light};
  --google-button-border: #{dt.$google-button-border-light};
  --google-button-hover-bg: #{dt.$google-button-hover-bg-light};
  --google-button-hover-border: #{dt.$google-button-hover-border-light};
  --google-button-active-bg: #{dt.$google-button-active-bg-light};
  --google-button-disabled-text: #{dt.$google-button-disabled-text-light};
  --google-button-disabled-border: #{dt.$google-button-disabled-border-light};

  // Glass morphism variables for light theme
  --glass-background: rgba(255, 255, 255, 0.75);
  --glass-border: rgba(0, 0, 0, 0.1);

  // Glass secondary colors (for secondary-glass buttons and similar elements)
  --color-glass-secondary: rgba(120, 120, 128, 0.12);
  --color-glass-secondary-hover: rgba(120, 120, 128, 0.2);
  --color-glass-secondary-active: rgba(120, 120, 128, 0.25);

  // Admin badge colors - soft amber for light theme
  --admin-badge-bg: rgba(217, 119, 6, 0.12);
  --admin-badge-text: #b45309;
  --admin-icon-color: #d97706;

  // Chat bubble colors - light theme
  --chat-my-bubble-bg: rgba(59, 130, 246, 0.9);
  --chat-my-bubble-border: rgba(59, 130, 246, 0.3);
  --chat-my-bubble-text: #ffffff;
  --chat-my-bubble-timestamp: rgba(255, 255, 255, 0.7);
  --chat-other-bubble-bg: var(--glass-background);
  --chat-other-bubble-border: var(--glass-border);
  --chat-other-bubble-text: var(--color-text-primary);
  --chat-other-bubble-timestamp: var(--color-text-muted);

  color: var(--color-text-primary);
  background-color: var(--color-background);
}

/* --- Dark Theme Variables --- */
body[data-theme='dark'] {
  --color-primary: #{dt.$color-primary};
  --color-primary-hover: #{dt.$color-primary-hover};
  --color-primary-light: #{dt.$color-primary-light};

  --color-secondary: #{dt.$color-gray-500};
  --color-secondary-hover: #{dt.$color-gray-400};

  --color-background: #{dt.$color-gray-900};
  --color-surface: #{dt.$color-gray-800};
  --color-surface-elevated: #{dt.$color-gray-700};
  --color-surface-hover: #{dt.$color-gray-700};

  --color-border: #{dt.$color-gray-600};
  --color-border-strong: #{dt.$color-gray-500};
  --color-border-light: #{dt.$color-gray-700};

  --color-text-primary: #{dt.$color-gray-50};
  --color-text-secondary: #{dt.$color-gray-300};
  --color-text-muted: #{dt.$color-gray-300};
  --color-text-disabled: #{dt.$color-gray-400};

  --color-success: #{dt.$color-success};
  --color-success-light: rgba(16, 185, 129, 0.15);
  --color-warning: #{dt.$color-warning};
  --color-warning-light: rgba(245, 158, 11, 0.15);
  --color-error: #{dt.$color-error};
  --color-error-light: rgba(239, 68, 68, 0.15);
  --color-error-banner-bg: rgba(69, 26, 26, 0.95);
  --color-error-banner-text: #fca5a5;
  --color-error-banner-border: rgba(127, 29, 29, 0.6);

  --color-overlay-light: rgba(255, 255, 255, 0.05);
  --color-overlay-medium: rgba(255, 255, 255, 0.15);
  --color-overlay-strong: #{dt.$color-backdrop};

  --color-canvas-background: #{dt.$color-board-dark-default};
  --color-canvas-pattern: rgba(255, 255, 255, 0.02);

  --color-random-shapes-bg: #{dt.$color-random-shapes-bg-dark};
  --color-random-shapes-pattern: #{dt.$color-random-shapes-pattern-dark};

  --color-status-pending-border: #{dt.$color-status-pending-border-dark};
  --color-status-confirmed-border: #{dt.$color-status-confirmed-border-dark};
  --color-status-failed-border: #{dt.$color-status-failed-border-dark};
  --color-status-failed-bg: #{dt.$color-status-failed-bg-dark};

  --toolbar-background: linear-gradient(
    135deg,
    rgba(24, 24, 27, 0.95) 0%,
    rgba(39, 39, 42, 0.98) 100%
  );
  --toolbar-border: rgba(63, 63, 70, 0.4);
  --toolbar-shadow: #{dt.$shadow-sm}, 0 0 0 1px rgba(255, 255, 255, 0.06) inset;

  --nav-button-background: linear-gradient(
    135deg,
    rgba(39, 39, 42, 0.8) 0%,
    rgba(52, 52, 55, 0.9) 100%
  );
  --nav-button-border: rgba(82, 82, 91, 0.4);
  --nav-button-text: #{dt.$color-gray-300};
  --nav-button-shadow: #{dt.$shadow-sm}, 0 0 0 1px rgba(255, 255, 255, 0.06) inset;
  --nav-button-hover-background: linear-gradient(
    135deg,
    rgba(52, 52, 55, 0.95) 0%,
    rgba(63, 63, 70, 1) 100%
  );
  --nav-button-hover-border: #{dt.$color-gray-50};
  --nav-button-hover-text: #{dt.$color-white};
  --nav-button-hover-shadow: #{dt.$shadow-button-hover}, 0 0 0 1px rgba(255, 255, 255, 0.1) inset;

  --destructive-button-background: linear-gradient(
    135deg,
    rgba(69, 26, 26, 0.6) 0%,
    rgba(87, 13, 13, 0.7) 100%
  );
  --destructive-button-border: rgba(153, 27, 27, 0.4);
  --destructive-button-text: #{dt.$color-error-light};
  --destructive-button-shadow: #{dt.$shadow-sm}, 0 0 0 1px rgba(254, 226, 226, 0.06) inset;
  --destructive-button-hover-background: linear-gradient(
    135deg,
    rgba(87, 13, 13, 0.8) 0%,
    rgba(127, 29, 29, 0.9) 100%
  );
  --destructive-button-hover-border: #{dt.$color-error-light};
  --destructive-button-hover-text: #{dt.$color-error-light};
  --destructive-button-hover-shadow:
    #{dt.$shadow-button-hover}, 0 0 0 1px rgba(254, 226, 226, 0.1) inset;

  --language-toggle-bg: #374151;

  --btn-primary-bg: #{dt.$color-primary};
  --btn-primary-bg-hover: #{dt.$color-primary-hover};
  --btn-primary-text: #{dt.$color-gray-50};

  --btn-secondary-bg: #{dt.$color-gray-700};
  --btn-secondary-bg-hover: #{dt.$color-gray-600};
  --btn-secondary-text: #{dt.$color-gray-100};
  --btn-secondary-border: #{dt.$color-gray-600};

  --btn-destructive-bg: #{dt.$color-error-hover};
  --btn-destructive-bg-hover: #{dt.$color-error};
  --btn-destructive-text: #{dt.$color-white};

  --btn-cta-bg: #{dt.$color-success};
  --btn-cta-bg-hover: #{dt.$color-success};
  --btn-cta-text: #{dt.$color-white};

  --btn-warning-bg: #{dt.$color-warning};
  --btn-warning-bg-hover: #{dt.$color-warning};
  --btn-warning-text: #{dt.$color-black};

  --btn-icon-bg-hover: #{dt.$color-gray-700};
  --btn-icon-text: #{dt.$color-gray-400};
  --btn-icon-active-border: #{dt.$color-gray-500};

  // Icon button glass backgrounds (dark theme - dark overlays)
  --icon-btn-bg: rgba(255, 255, 255, 0.08);
  --icon-btn-bg-hover: rgba(255, 255, 255, 0.12);
  --icon-btn-bg-active: rgba(255, 255, 255, 0.15);
  --icon-btn-bg-active-hover: rgba(255, 255, 255, 0.18);

  --scrollbar-track-bg: #{dt.$color-gray-900};
  --scrollbar-thumb-bg: #{dt.$color-gray-700};
  --scrollbar-thumb-hover-bg: #{dt.$color-gray-600};
  --scrollbar-corner-bg: #{dt.$color-gray-900};

  --google-button-bg: #{dt.$google-button-bg-dark};
  --google-button-text: #{dt.$google-button-text-dark};
  --google-button-border: #{dt.$google-button-border-dark};

  // Glass morphism variables for dark theme
  --glass-background: rgba(39, 39, 42, 0.75);
  --glass-border: rgba(255, 255, 255, 0.1);

  // Glass secondary colors (for secondary-glass buttons and similar elements)
  --color-glass-secondary: rgba(120, 120, 128, 0.15);
  --color-glass-secondary-hover: rgba(120, 120, 128, 0.25);
  --color-glass-secondary-active: rgba(120, 120, 128, 0.3);

  --google-button-hover-bg: #{dt.$google-button-hover-bg-dark};
  --google-button-hover-border: #{dt.$google-button-hover-border-dark};
  --google-button-active-bg: #{dt.$google-button-active-bg-dark};
  --google-button-disabled-text: #{dt.$google-button-disabled-text-dark};
  --google-button-disabled-border: #{dt.$google-button-disabled-border-dark};

  // Admin badge colors - warm amber for dark theme
  --admin-badge-bg: rgba(251, 191, 36, 0.15);
  --admin-badge-text: #fbbf24;
  --admin-icon-color: #fbbf24;

  // Chat bubble colors - dark theme
  --chat-my-bubble-bg: rgba(37, 99, 235, 0.85);
  --chat-my-bubble-border: rgba(59, 130, 246, 0.4);
  --chat-my-bubble-text: #ffffff;
  --chat-my-bubble-timestamp: rgba(255, 255, 255, 0.6);
  --chat-other-bubble-bg: var(--glass-background);
  --chat-other-bubble-border: var(--glass-border);
  --chat-other-bubble-text: var(--color-text-primary);
  --chat-other-bubble-timestamp: var(--color-text-muted);

  color: var(--color-text-primary);
  background-color: var(--color-background);
}

a {
  font-weight: dt.$font-weight-medium;
  color: var(--color-primary);
  text-decoration: inherit;
  transition: dt.$transition-colors;

  &:hover {
    color: var(--color-primary-hover);
  }
}

body {
  margin: 0;
  min-width: 320px;
  // Disable blue tap highlight on mobile devices
  -webkit-tap-highlight-color: transparent;
}

h1 {
  font-size: dt.$font-size-2xl;
  line-height: dt.$line-height-tight;
}

button:focus,
button:focus-visible {
  outline: 4px auto -webkit-focus-ring-color;
}

* {
  scrollbar-width: thin;
  scrollbar-color: var(--scrollbar-thumb-bg) var(--scrollbar-track-bg);
}

*::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

*::-webkit-scrollbar-track {
  background: var(--scrollbar-track-bg);
  border-radius: dt.$border-radius-sm;
}

*::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb-bg);
  border-radius: dt.$border-radius-sm;
  border: none;
  transition: dt.$transition-colors;

  &:hover {
    background: var(--scrollbar-thumb-hover-bg);
  }
}

*::-webkit-scrollbar-corner {
  background: var(--scrollbar-corner-bg);
}

// Screen reader only utility class - hides elements visually but keeps them accessible
// Uses the visually-hidden mixin from _mixins.scss for consistency
.sr-only {
  @include mixins.visually-hidden;
}

// Vaul drawer styles - prevent body scroll when drawer is open
// Vaul adds data-vaul-drawer-visible attribute when drawer opens
body[data-vaul-drawer-visible='true'] {
  overflow: hidden;
  position: fixed;
  width: 100%;
}

// Prevent body scroll on board page (canvas has its own scroll)
// Uses data-board-page attribute set on the main element in BoardPage
body:has([data-board-page]) {
  overflow: hidden;
  position: fixed;
  width: 100%;
  height: 100%;
}

// Ensure proper viewport behavior on mobile when keyboard opens
// This prevents the page from scrolling/jumping when input is focused
@supports (-webkit-touch-callout: none) {
  // iOS Safari specific
  html {
    // Use the small viewport height which doesn't include the URL bar
    height: -webkit-fill-available;
  }

  body {
    min-height: -webkit-fill-available;
  }
}
