@use '@/styles' as theme;

// --- Modal Layout ---

// Full-screen modal overlay container
.overlay {
  @include theme.fixed-overlay;
  @include theme.flex-center;
  background-color: transparent; // No background - backdrop handles it
  padding: theme.$spacing-0 theme.$spacing-4;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
  z-index: theme.$z-index-modal !important;
  // DO NOT add overflow-y: auto here - only content should scroll, not overlay
}

// Clickable backdrop behind modal content
.backdrop {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background-color: theme.$overlay-strong;
  border: none;
  cursor: pointer;
  z-index: 0; // Behind the content
}

// Modal content container with responsive sizing
.content {
  @include theme.card-base;
  @include theme.rounded-medium;
  @include theme.shadow-heavy;
  @include theme.theme-scrollbar;
  background: var(--user-chosen-color, var(--glass-background));
  opacity: 1;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: theme.$border-width solid var(--glass-border);
  min-width: theme.$modal-min-width;
  max-width: theme.$modal-max-width;
  max-height: 70vh;
  height: fit-content;
  position: relative !important;
  z-index: 10 !important; // Above backdrop (z-index: 0)
  overflow-y: auto; // Content scrolls, not overlay
  margin: theme.$spacing-6 auto;

  &:hover {
    opacity: 0.98;
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
  }
}

// Special override for wide modals (like create board form)
:global(.modal-wide) .content {
  max-width: 700px;
  width: 100%;
}

// Floating close button in top-right corner - uses sticky positioning to stay visible while scrolling
.closeButton {
  position: sticky !important;
  top: theme.$spacing-2 !important;
  inset-inline-start: calc(100% - 40px) !important;
  margin-bottom: -40px !important; // Pull content up to overlap where button was
  background: theme.$surface-hover !important;
  backdrop-filter: blur(theme.$blur-sm) !important;
  border: theme.$border-width solid theme.$border-strong !important;
  border-radius: theme.$border-radius-sm !important;
  font-size: theme.$font-size-base !important;
  padding: theme.$spacing-2 !important;
  line-height: 1 !important;
  z-index: 100 !important;
  min-width: 36px !important;
  min-height: 36px !important;
  width: 36px !important;
  height: 36px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  flex-shrink: 0 !important;
}

// --- Responsive Design ---

// Tablet responsive adjustments
@media (max-width: theme.$breakpoint-md) {
  .overlay {
    padding: theme.$spacing-4 theme.$spacing-2;
  }

  .content {
    min-width: 280px;
    max-width: calc(100vw - theme.$spacing-4);
    max-height: calc(100vh - theme.$spacing-8);
    padding: theme.$spacing-6;
    margin: theme.$spacing-4 auto;
  }

  .closeButton {
    top: theme.$spacing-2 !important;
    inset-inline-start: calc(100% - 44px) !important;
  }
}

// Mobile responsive adjustments
@media (max-width: theme.$breakpoint-sm) {
  .overlay {
    padding: theme.$spacing-2;
    align-items: center;
    justify-content: center;
  }

  .content {
    min-width: 280px;
    width: calc(100vw - 32px) !important;
    max-width: calc(100vw - 32px) !important;
    max-height: calc(100vh - 32px) !important;
    margin: 0 !important;
    border-radius: theme.$border-radius-md;
    padding: theme.$spacing-4;
    overflow-y: auto;
    display: flex !important;
    flex-direction: column !important;
  }

  .closeButton {
    top: theme.$spacing-1 !important;
    inset-inline-start: calc(100% - 40px) !important;
    min-width: 32px !important;
    min-height: 32px !important;
    width: 32px !important;
    height: 32px !important;
    margin-bottom: -36px !important;
  }
}