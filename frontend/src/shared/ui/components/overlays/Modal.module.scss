@use '@/styles' as theme;

// --- Modal Layout ---

// Full-screen modal overlay container
.overlay {
  @include theme.fixed-overlay;
  @include theme.flex-center;
  background-color: transparent; // No background - backdrop handles it
  padding: theme.$spacing-0 theme.$spacing-4;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  position: fixed !important;
  z-index: theme.$z-index-modal !important;
  // DO NOT add overflow-y: auto here - only content should scroll, not overlay
}

// Clickable backdrop behind modal content
.backdrop {
  position: fixed !important;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  background-color: theme.$overlay-strong;
  border: none;
  cursor: pointer;
  z-index: 0; // Behind the content
}

// Modal content container with responsive sizing
.content {
  @include theme.card-base;
  @include theme.rounded-medium;
  @include theme.shadow-heavy;
  @include theme.theme-scrollbar;
  background: var(--user-chosen-color, var(--glass-background));
  opacity: 0.96;
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: theme.$border-width solid var(--glass-border);
  min-width: theme.$modal-min-width;
  max-width: theme.$modal-max-width;
  max-height: 70vh;
  height: fit-content;
  position: relative !important;
  z-index: 10 !important; // Above backdrop (z-index: 0)
  overflow-y: auto; // Content scrolls, not overlay
  margin: theme.$spacing-6 auto;
  
  &:hover {
    opacity: 0.98;
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
  }
}

// Special override for wide modals (like create board form)
:global(.modal-wide) .content {
  max-width: 700px;
  width: 100%;
}

// Floating close button in top-right corner
.closeButton {
  position: absolute;
  top: theme.$spacing-4;
  inset-inline-end: theme.$spacing-4;
  background: theme.$surface-hover;
  backdrop-filter: blur(theme.$blur-sm);
  border: theme.$border-width solid theme.$border-strong;
  @include theme.rounded-small;
  font-size: theme.$font-size-base;
  padding: theme.$spacing-2;
  line-height: 1;
  z-index: 100; // Above content
  min-width: auto;
  width: theme.$spacing-8;
  height: theme.$spacing-8;
  display: flex;
  align-items: center;
  justify-content: center;
}

// --- Responsive Design ---

// Tablet responsive adjustments
@media (max-width: theme.$breakpoint-md) {
  .overlay {
    padding: theme.$spacing-4 theme.$spacing-2;
  }

  .content {
    min-width: 280px;
    max-width: calc(100vw - theme.$spacing-4);
    max-height: calc(100vh - theme.$spacing-8);
    padding: theme.$spacing-6;
    margin: theme.$spacing-4 auto;
  }

  .closeButton {
    top: theme.$spacing-3;
    inset-inline-end: theme.$spacing-3;
    font-size: theme.$font-size-base;
  }
}

// Mobile responsive adjustments
@media (max-width: theme.$breakpoint-sm) {
  .overlay {
    padding: theme.$spacing-2;
    align-items: center; // Explicitly center vertically
    justify-content: center; // Explicitly center horizontally
  }

  .content {
    min-width: 280px; // Prevent collapse
    width: calc(100vw - 32px) !important; // Explicit width for mobile with important
    max-width: calc(100vw - 32px) !important; // Account for overlay padding
    max-height: calc(100vh - 32px) !important; // Account for overlay padding
    margin: 0 !important; // Remove auto margin on mobile, flex handles centering
    border-radius: theme.$border-radius-md;
    padding: theme.$spacing-4;
    padding-top: theme.$spacing-12;
    overflow-y: auto; // Ensure scrolling works for tall content
    display: flex !important; // Ensure flex display
    flex-direction: column !important; // Stack content vertically
  }
}