# =============================================================================
# SynchBoard Application Configuration
# =============================================================================
# This file configures the Spring Boot backend application.
# Environment variables are loaded from .env file via dotenv-java library.
# See .env.example for required environment variables.
# =============================================================================

spring.application.name=backend

# =============================================================================
# Database Configuration (PostgreSQL)
# =============================================================================
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=${JPA_DDL_AUTO}
spring.jpa.open-in-view=false

# =============================================================================
# Security & JWT Configuration
# =============================================================================
app.jwt.secret-key=${JWT_SECRET_KEY}
app.jwt.expiration-hours=${JWT_EXPIRATION_HOURS:24}
app.security.allowed-origins=${CLIENT_ORIGIN_URL:http://localhost:5173}

# =============================================================================
# WebSocket & Message Broker Configuration (ActiveMQ Artemis)
# =============================================================================
app.stomp.broker-host=${STOMP_BROKER_HOST}
app.stomp.broker-port=${STOMP_BROKER_PORT}

spring.activemq.broker-url=${ACTIVEMQ_BROKER_URL}
spring.activemq.user=${ACTIVEMQ_USER}
spring.activemq.password=${ACTIVEMQ_PASSWORD}

# =============================================================================
# File Upload Configuration
# =============================================================================
spring.servlet.multipart.enabled=true
spring.servlet.multipart.max-file-size=${MAX_FILE_SIZE_MB:10}MB
spring.servlet.multipart.max-request-size=${MAX_REQUEST_SIZE_MB:10}MB
app.upload.dir=${UPLOAD_DIRECTORY:./uploads}

# =============================================================================
# Email Configuration (Gmail REST API)
# =============================================================================
# Gmail API credentials are read directly from environment variables:
# - GMAIL_CLIENT_ID: OAuth2 Client ID from Google Cloud Console
# - GMAIL_CLIENT_SECRET: OAuth2 Client Secret from Google Cloud Console
# - GMAIL_REFRESH_TOKEN: OAuth2 Refresh Token for offline access
# - GMAIL_SENDER_EMAIL: Gmail address used to send emails
# See docs/EMAIL_SERVICE.md for setup instructions.

# =============================================================================
# Verification & Password Reset Configuration
# =============================================================================
# Note: EmailService.java reads these values directly from environment variables.
# The properties below provide Spring configuration metadata and documentation.
# VERIFICATION_EXPIRY_MINUTES: used for email verification code expiry (default: 15 min)
# PASSWORD_RESET_EXPIRY_MINUTES: used for password reset code expiry (default: 60 min)
# VERIFICATION_MAX_ATTEMPTS: maximum verification attempts before lockout (default: 3)

verification.code-expiry-minutes=${VERIFICATION_EXPIRY_MINUTES:15}
verification.max-attempts=${VERIFICATION_MAX_ATTEMPTS:3}
password-reset.code-expiry-minutes=${PASSWORD_RESET_EXPIRY_MINUTES:60}

# =============================================================================
# OAuth2 Configuration (Google)
# =============================================================================
# OAuth2 properties are configured conditionally in OAuth2Config.java
# only when GOOGLE_CLIENT_ID environment variable is provided.

app.oauth2.frontend-base-url=${OAUTH2_FRONTEND_BASE_URL:http://localhost:5173}

# =============================================================================
# Server Configuration (Tomcat)
# =============================================================================
server.tomcat.max-swallow-size=-1
server.tomcat.max-http-form-post-size=${MAX_REQUEST_SIZE_MB:10}MB
server.max-http-request-header-size=1MB

# =============================================================================
# Logging Configuration
# =============================================================================
logging.level.root=INFO
logging.level.io.github.sagimenahem.synchboard=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n
logging.file.name=${LOG_FILE_PATH:logs/synchboard.log}

# Suppress noisy Spring Security warning about missing UserDetailsService
logging.level.org.springframework.security.config.annotation.authentication.configuration.InitializeUserDetailsBeanManagerConfigurer=ERROR
